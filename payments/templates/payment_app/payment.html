<!DOCTYPE html>
<html>
<head>
  <title>Razorpay Payment Test</title>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
  <h2>Test Razorpay Payment</h2>
  <button id="pay-button">Pay Now</button>

  <script>
    document.getElementById('pay-button').onclick = function () {
      fetch('/payments/create-order/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          amount: 50000,  // â‚¹500 (in paise)
          currency: 'INR',
          receipt: 'receipt_001'
        })
      })
      .then(response => response.json())
      .then(order => {
        var options = {
          key: "rzp_test_DEaHzFF8ABaRkz", // ðŸ” Replace with actual key
          amount: order.amount,
          currency: order.currency,
          name: "Test Corp",
          description: "Test Transaction",
          order_id: order.id,
          handler: function (response) {
            // Call verify-payment endpoint
            fetch('/payments/verify/', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                razorpay_payment_id: response.razorpay_payment_id,
                razorpay_order_id: response.razorpay_order_id,
                razorpay_signature: response.razorpay_signature
              })
            })
            .then(res => res.json())
            .then(data => {
              alert(data.message || data.error);
            });
          },
          theme: {
            color: "#3399cc"
          }
        };
        var rzp = new Razorpay(options);
        rzp.open();
      });
    };
  </script>
</body>
</html>
